# LeetCode678 有效的字符串 题解

## 一、题目描述

给定一个只包含三种字符的字符串：（ ，） 和 *，写一个函数来检验这个字符串是否为有效字符串。有效字符串具有如下规则：

任何左括号 ( 必须有相应的右括号 )。
任何右括号 ) 必须有相应的左括号 ( 。
左括号 ( 必须在对应的右括号之前 )。
* 可以被视为单个右括号 ) ，或单个左括号 ( ，或一个空字符串。
一个空字符串也被视为有效字符串。

**注意:**

1. 字符串大小将在 [1，100] 范围内。



## 二、分析

### 1. 动态规划

这是一道与“括号匹配”类似的题目，而 **括号匹配除了使用栈，还可以使用动态规划求解，时间复杂度为$O(N^2)$**。

设$dp[i][j]$为$[i,j]$范围字符串是否是有效括号字符串，$dp[i][i]$仅当$s[i]=*$时为真，$dp[i][i+1]$仅当$s[i,j]=() / (* / *)/**$为真。之后正常状态转移即可。

### 2. 使用双栈 + 贪心

**这是一个启发，可以设置不同优先级的栈，优先处理优先级高的**。

**建立左括号栈和星号栈，每次遇到右括号优先弹出左括号栈的元素**。

### 3. 正反遍历 + 贪心

正向遍历要求左括号数 + 星号数 >= 右括号数。

反向遍历要求右括号数 + 星号数 >= 左括号数。

(莫名其妙的对了。。。)



## 三、代码

### 1. 正反遍历 + 贪心

```c++
bool checkValidString(string s) {
    int diff = 0, star = 0;
    for (int i = 0; s[i]; i++) {
        if (s[i] == '(') diff++;
        else if (s[i] == ')') diff--;
        else star++;
        if (diff < 0) {
            if (star) diff++, star--;
            else return false;
        }
    }
    if (diff > star) return false;
    diff = star = 0;
    int n = s.size();
    for (int i = n - 1; i >= 0; i--) {
        if (s[i] == ')') diff++;
        else if (s[i] == '(') diff--;
        else star++;
        if (diff < 0) {
            if (star) diff++, star--;
            else return false;
        }
    }
    return diff <= star;
}
```

