# LeetCode634 寻找数组的错位排列 题解

## 一、题目描述

在组合数学中，如果一个排列中所有元素都不在原先的位置上，那么这个排列就被称为 **错位排列** 。

给定一个从 `1` 到 `n` 升序排列的数组，返回 ***不同的错位排列** 的数量* 。由于答案可能非常大，你只需要将答案对 `10^9+7` **取余** 输出即可。

**提示：**

- `1 <= n <= 10^6`



## 二、分析

### 1. 线性DP

设状态$dp[i]$表示1到i的错位排列，假设1被放在x处：

+ x被放在1处，则对应$dp[i-2]$，一共$(i-1)*dp[i-2]$。
+ x没有被放在1处，则$[1,i]-\{1\}$等价于$[1,i-1]$的错位排列，一共$(i-1)*dp[i-1]$。



## 三、代码

### 1. 线性DP

```c++
long MOD = 1e9 + 7;

int findDerangement(int n) {
  long dp[n + 10];
  memset(dp, 0, sizeof(dp));
  dp[2] = 1;
  for (long i = 3; i <= n; i++)
    dp[i] = (i - 1) * (dp[i - 1] + dp[i - 2]) % MOD;
  return dp[n];
}
```

